<div class='container ds-about'>
  <div class='ds-section'>
	<h1>
	  空间分析概述
	</h1>

    <p>
      对于建筑空间进行分析，在西方文艺复兴前后，就已经开始尝试。跨越不同历史年代的建筑理论家，提出了不同的空间分析的思路。
    </p>

    <p>
      有的人走了文史哲的路子，通过类似于小说那样的叙事系统，来描述和分析建筑空间。走这个路子的代表人物是巴黎圣母院最早的院长絮热。文史哲的路子，容易走火入魔，进入繁琐哲学的漩涡当中，文本越来越长，但思维却越来越僵化。
    </p>

    <p>
      另一些人走了数理化的路子，通过某种数学的语言，希望对建筑空间进行精确分析。走这个路子的代表人物如欧拉，解决哥尼斯堡的七座桥的问题的那个人，开创了拓扑学和图论的数学领域。数学的方式，以其简洁优美，空灵生动的特点，吸引了大批有理工科背景的建筑学人，沿着这个路子探索。数学的方式，在没有现代计算机科学的情况下，也不一定走得通。因为计算量远远超出人的手工计算的能力范围。
    </p>

    <p>
      美好的思想，想要落地成为工程实际，等了几百年。直到计算机的这一套系统上来之后，空间分析的工具才得到了比较充分的发展，建筑学领域内空间分析的思路才能够按照理想状态展开。DepthSapce 这套空间分析的工具集，可以为建筑师提供精确的描述空间和分析空间的方法，为他们的艺术创想或工程实践提供前所未见的有力武器。
    </p>

    <p>
      DepthSpace 这个名称，是顺着 DepthMap 来的。DepthMap 是中国的建筑师最早熟练使用的空间分析工具，我自己写教材普及这个事情，折腾了好多年。写教材中暴露的问题也不少。最主要的是DepthMap只有简陋的二维分析能力。这也没法抱怨，因为DepthMap的开发工作始于上世纪九十年代，当时的硬件条件有限，内存那时候只有几十MB,编程工具也不是那么利索,C++的编程语言，里面很多坑，对程序员的要求极高。对于建筑师来说，二维空间分析远远不能满意，二维空间只是个示意图，二维的方法肯定解决不了三维的问题。
    </p>

    <p>
      不论 DepthMap 如何简陋，筚路蓝缕，以启山林，开创者的艰难，我们还是铭记在心。到了 DepthSpace 的阶段，没开始之前，我就要求，这次开发彻底搞成三维模型。再简陋的三维模型都行。
    </p>

    <p>
      非要走三维的路子，我们面临的技术门槛就多了。现在开发完了，回头来看，开发历程还挺惊心动魄的。
    </p>

    <p>
      第一个门槛是直接使用真实的三维建筑模型。建筑设计行业广泛使用的软件，从最早的AutoCAD 到 3dMax，到 Rhinoceros，到比较迟出现的 SketchUp，新的建模工具层出不穷，如何能够把这些建模软件提供的基础模型，解析成能够参与空间分析的点线面的信息，还是费了不少功夫。建筑师常用的如 DWG 格式的文件，这都是二进制的保存方式，也不是不能解析，但终究是存在诸多不爽的地方。测试了好长时间，我们才找到最方便最通用的用于模型输出的文件格式。现在，DepthSpace 可以接收几乎任何建模软件传来的基础模型。
    </p>

    <p>
      解决了转换格式问题之后不久，我们也彻底研究清楚了 Rhinoceros 用来描述自由曲面的这一整套技术，可以直接接受自由曲面参与运算，且计算效率下降不多。
    </p>

    <p>
      第二个门槛是计算速度的门槛。假设一股人流是五百毫米的宽度，那么 150 米见方的一个平面，变成点阵，就需要十万个点去描述。以现在的建筑工业的水平，动辄几十万平米的建筑物，转换成点阵，再参与计算，要求的点阵的规模，指数型上升，要求的计算能力，是一般人无法想象的。硬件资源有限的情况下，要解决如此规模的难题，需要的数学基础，已经到了数学家的程度了。
    </p>

    <p>
      如果不解决计算能力的问题，退而求其次，就要把复杂的问题简化。据说 DepthMap 这个软件，底层都是采样算法，通过采样的办法直接降低参与计算的元素数量，从而使得总的计算量下降到可以承受的范围内。但采样这个事情，涉及到算法和数据结构的一些深层次的内容，里面麻烦很大，很有可能返回错误的结果。最好是原原本本的百分之百参与计算。
    </p>

    <p>
      如果计算太慢，那么计算本身可能就没有价值了。为了速度，必须使用并行计算的技术。当下，并行计算的专用硬件已经获得较大发展，硬件厂商为了支撑硬件的应用，又发布了专门的软件开发工具。已经造成，并行计算有关的知识系统已经极其臃肿。又能够掌握空间数学，又能够直接进行硬件编程的人，极其难找。人才的门槛，极难跨越。
    </p>

    <p>
      费了千辛万苦，人我也找到了。从搞航空的人里面，找到一个牛人，向我展示了基于GPU的并行计算与一般的 32 核心 CPU 计算的速度差异，提速大约 15000 倍。这是极其激动人心的技术成就。
    </p>

    <p>
      此后，我们终于组成了一个小团队，于 2016 年春节后，进入了实际的软件开发环节。
    </p>

    <p>
      第三个门槛是计算结果的表现的问题。DepthMap那个阶段，我们已经习惯了使用Color Map，从红色到蓝色，对物体赋予颜色。三维空间中，赋予颜色之后，物体之间互相有遮挡，怎么把这个颜色展现出来，还面临不小的问题。解决办法是使用Rhino直接对物体赋予颜色，或者，在点阵数量不太大的情况下，也能用webGL技术，通过网页进行查看。
    </p>

    <p>
      在不远的将来，我们可能推出自家的模型浏览软件，可以直接对外输出视频或GIF动图的那种。已经提上议事日程，慢慢完善思路中。
    </p>

    <p>
      最后不得不说的是，还有个门槛，就是防盗版的门槛。中国的软件用户，没有使用正版软件的习惯。实际上，没有软件支撑，不论多贵的硬件，那都是死宝。软件的价值，比硬件高多了。如果允许盗版，那么当初软件研发活动就不能开始。
    </p>

    <p>
      为了解决盗版问题，我们一开始就决定走云计算的道路。用户真正使用的，其实只是计算之后给出的结果。软件实际怎么工作，怎么安排算法，怎么安排数据结构，甚至软件运行于哪台计算机上，这些东西其实建筑师管不了。
    </p>

    <p>
      在空间分析的这些软件功能的开发过程中，我们顺带着，一边做测试，一边也就把服务器管理的事情也写成脚本，解决了。我们把服务器管理的需求从头到尾理出来，写成对应的脚本，如果运行中，服务器没有内存出错的话，基本上可以全年不中断运行。
    </p>

    <p>
      我们对数据安全极为重视，我们的数据中心与外界是物理隔离的，不联网。数据中心内部操作使用的是DELL零客户机解决方案，工作人员与实际摆放服务器的机房也是隔离的，工作人员面前的主机，实际上接收的是像素广播，文件并不“落地”。
    </p>

    <p>
      在数据中心内部，跑模型的主机本身不带存储，存储是使用直接连接存储，放在专门的存储系统上的。存储系统也包含几部分，操作加密解密的主机与磁盘是分离的，没有PKI服务器进行正确授权，存储的那些文件就是一堆乱码。
    </p>

    <p>
      没走公司审批流程，没取得服务器登录权限的情况下，即便把主机抱走了也没用。
    </p>

    <p>
      对外服务客户的时候，我们开发了专门的优盾，并开发了新的自有加密算法，加密解密的过程都是在优盾内部的芯片上跑的，即便出品优盾的这个硬件厂商，想要破解这套工作机制，他也需要把对应的两只优盾都拿到手才行。原理上，非对称加密的系统，每一对密钥都是独立的，也就造成每一组优盾都是独立的，即便破解对应的两只一组的优盾，也不影响其他的优盾组。总之，这套系统的数学基础十分坚固，就是我们自己想破坏，都不是那么容易。
    </p>

    <p>
      跨过了上述这几个门槛，经过一年多的开发之后，我们预想的功能都已实现。经过内部试，我们认为空间分析的这套东西，业务逻辑正确，计算能力充足，可以推向市场了。
    </p>

    <p>
      在 DepthSpace 推向市场之际，我衷心希望，依托于我们的新技术，中国的建筑师，这个群体，能够摆脱自明朝中叶以来，在工具，技术和思想方面的落后局面，直达人类建筑历史的最高境界。
    </p>

  </div>
</div>
